============================================================================
                ＭＳ−ＤＯＳ主要ファンクションコール一覧

			   β版 Version 0.24

			  Written by Kattyo@abk.
			Part modified by nabe@abk.
============================================================================

※ＴＡＢサイズ８でお読みください. 
※このテキストファイルは, MS-DOSの主要ファンクションコールをのせたものです. 
  説明は, ファイルの最後方にあります. 
※邪悪にも, いくらか半角カナが使用されています. 
※全てが正しく書かれているとは限りません。

●00H
□プログラムの終了
	IN  AH 00H
	    CS PSPのパラグラフ番号
	Ret なし

●01H
□標準入力から文字入力
	[CTRL-C][ECHO]
	IN  AH 01H
	Ret AL 入力された文字コード
	備考 ^P は有効.

●02H
□標準出力へ文字出力
	[CTRL-C]
	IN  AH 02H
	    DL 出力する文字コード
	Ret なし

●03H
□標準ＡＵＸ入力
	[CTRL-C]
	IN  AH 03H
	Ret AL ＡＵＸから入力された文字コード

●04H
□標準ＡＵＸ出力
	[CTRL-C]
	IN  AH 04H
	    DL ＡＵＸに出力する文字コード
	Ret なし

●05H
□プリンタ出力
	[CTRL-C]
	IN  AH 05H
	    DL プリンタに出力する文字コード
	Ret なし

●06H
□コンソールとの直接文字入出力
	IN  AH 06H
	    入力の場合 DL FFH
	    出力の場合 DL 出力する文字
	Ret 入力の場合 ゼロフラグがセット AL=0 入力無し
		       ゼロフラグがリセット AL=文字コード

●07H
□標準入力から文字入力
	IN  AH 07H
	Ret AL 標準入力から入力された文字コード

●08H
□標準入力からの文字入力
	[CTRL-C][ECHO]
	IN  AH 08H
	Ret AL 標準入力より入力された文字コード

●09H
□文字列の出力
	[CTRL-C]
	IN  AH 09H
	    DS:DX 標準出力に出力する文字列のアドレス(最後が'$'でおわる)

●0AH
□バッファード・キーボード入力
	[CTRL-C]
	IN  AH 0AH
	    DS:DX 入力バッファの先頭アドレス
	Ret なし
	備考 入力バッファの形式は特殊である

●0BH
□標準入力のステータスチェック
	[CTRL-C]
	IN  AH 0BH
	Ret AL 00 バッファは空である
	       FF バッファは文字が入っている

●0CH
□バッファを空にして入力
	IN  AH 0CH
	    AL タイプアヘッドバッファを空にしたあと行うファンクションコール番号
	       01H or 06H or 07H or 08H or 1AH
	       その他の値なら, バッファを空にするだけ
	Ret  ALに指定したファンクションコールを実行したあとそれぞれのレジスタに
	     それぞれのファンクションコールの戻り値が入る
	     ファンクション番号をその他にした場合, AL=00H
●0DH
□ディスクのリセット
	IN  AH 0DH
	Ret なし
	備考 DOS のバッファにたまっていたデータを全て書き出す

●0EH
□ドライブの選択
	IN  AH 0EH
	    DL ドライブ番号(0=A,1=B ...)
	Ret AL MS-DOSが使用可能な最大のドライブ数(LASTDRIVEの値)

●18H
□何もしない
	IN  AH 18H
	Ret Al 00H
	備考 CP/M コンパチのためのダミーファンクション. なにもしない.

●19H
□カレントドライブ番号の読み出し
	IN  AH 19H
	Ret AL 現在選択されているドライブ(0=A,B=1...)

●1AH
□DTAアドレス設定
	IN  AH 1AH
	    DS:DX 新しい DTA アドレス
	Ret なし
	備考 DTA を設定しない場合, PSP:080H がデフォルトで使われる.

●1BH
□カレントドライブデータの読み出し
	IN  AH 1BH
	Ret AL １クラスタ あたりの セクタ数
	    CX １セクタ   あたりの バイト数
	    DX １ドライブ あたりの クラスタ数
	    DS:BX media ID byte のアドレス

	media ID:
	FFh	FD, 2D  両面, 8 セクタ/トラック  (320K)
	FEh	FD, 1D  片面, 8 セクタ/トラック  (160K)
	FDh	FD, 2D  両面, 9 セクタ/トラック  (360K)
	FCh	FD, 1D  片面, 9 セクタ/トラック  (180K)
	F9h	FD, 2HC 両面, 15 セクタ/トラック (1.2M)
		FD, 2DD 両面, 9 セクタ/トラック  (720K)
	F8h	HDD
	F0h	その他


●1CH
□ドライブデータの取得
	IN  AH 1CH
	    DL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	Ret ドライブ番号が無効 AL=FFH
	    ドライブ番号が有効↓
	    AL １クラスタ あたりの セクタ数
	    CX １セクタ   あたりの バイト数
	    DX １ドライブ あたりの クラスタ数
	    DS:BX media ID のアドレス

●1FH
□カレントドライブの DPB アドレス取得
	IN  AH 1FH
	Ret AL 00H 成功 DS:BX DPB のアドレス
	       FFH 失敗

	DPB:
	00h	BYTE	Device ID
	01h	BYTE	論理ドライブ番号
	02h	WORD	nバイト/セクタ
	04h	BYTE	クラスタの最大セクタ番号
	05h	BYTE	クラスタを何回shiftすればセクタになるか
	06h	WORD	FATのある最初のセクタ番号
	08h	BYTE	FATのコピー数
	09h	WORD	ディレクトリエントリ数
	0Bh	WORD	データの記録されている最初のセクタ番号
	0Dh	WORD	全データクラスタ数 + 1
	0Fh	BYTE	セクタ数/FAT
	10h	WORD	ディレクトリの最初のセクタ番号
	12h	WORD	FATアドレス

●25H
□割り込みベクタ設定
	IN  AH 25H
	    AL 割り込みベクタの番号
	    DS:DX エントリ・アドレス
	Ret なし

●26H
□新しいＰＳＰの作成
	IN  AH 26H
	    DX ＰＳＰを作成するパラグラフ番号
	Ret なし

●29H
□ファイル名の解析
	IN  AH 29H
	    AL *解析の制御フラグ
	    DS:SI 解析する文字列の先頭アドレス
	    ES:DI オープンされていないＦＣＢの先頭アドレス
	Ret AL 00H ワイルドカードが使用されていない
	       01H ワイルドカードが使用されている
	       FFH ドライブ名が無効である
	    DS:DI 解析された文字列の中のファイル名の直後のアドレス

●2AH
□日付の読み出し
	IN  AH 2AH
	Ret CX 年(1980-2079)
	    DH 月(1-12)
	    DL 日(1-31)
	    AL 曜日(0=日,1=月,2=火...)

●2BH
□日付の設定
	IN  AH 2BH
	    CX 年(1980-2079)
	    DH 月(1-12)
	    DL 日(1-31)
	Ret AL 00H 日付がセットされた
	       FFH 無効な日付である

●2CH
□時刻の読み出し
	IN  AH 2CH
	Ret CH 時(0-23)
	    CL 分(0-59)
	    DH 秒(0-59)
	    DL 1/100秒(0-99)

●2DH
□時刻の設定
	IN  AH 2DH
	    CH 時(0-23)
	    CL 分(0-59)
	    DH 秒(0-59)
	    DL 1/100秒(0-99)
	Ret AL 00H 時刻がセットされた
	       FFH 無効な時刻である

●2EH
□ベリファイフラグの設定
	IN  AH 2EH
            DL 00h (DOS1, DOS2 のみ)
	    AL b0 0 ベリファイを行う
	          1 ベリファイを行わない
	Ret なし

●2FH
□DTA アドレスの取得
	IN  AH 2FH
	Ret ES:BX 現在の DTA アドレス

●30H
□DOSのバージョン番号の取得
	IN  AH 30H
	    AL DOS5 (BH に何が入って帰ってくるか)
	       00H OEM 番号
	       01H バージョンフラグ
	Ret AH バージョン番号小数部
	    AL バージョン番号整数部
	    BH 〜DOS4 OEM番号 (戻り値未定)
	       DOS5〜 バージョンフラグ
	              bit3 1 DOS は ROM 内にある
	    BL:CX(24ビット) ユーザー番号 (戻り値未定)
	備考 MS-DOS 6.21 は 6.20 を返す.
	     Windows 95 は 7.00 を返す.
	     Windows NT DOS BOX では 5.00 が帰ってくる
	     OS/2 v1.? DOS BOX では AL に 0AH が入る.
	     OS/2 v2.? DOS BOX では AL に 14H が入る.
	     OS/2 v3.0 DOS VM  では 20.30 が帰ってくる.
	OEM 番号:
	00h	IBM
	01h	Compaq
	02h	MS Packaged Product
	04h	AT&T
	05h	ZDS (Zenith Electronics)
	06h	Hewlett-Packard
	07h	ZDS (Groupe Bull)
	0Dh	Packard-Bell
	16h	DEC
	23h	Olivetti
	28h	Texas Instruments
	29h	Toshiba
	33h	Novell (Windows/386 device IDs only)
	34h	MS Multimedia Systems (Windows/386 device IDs only)
	35h	MS Multimedia Systems (Windows/386 device IDs only)
	4Dh	Hewlett-Packard
	5Eh	RxDOS
	66h	PhysTechSoft (PTS-DOS)
	99h	General Software's Embedded DOS
	EEh	DR DOS
	EFh	Novell DOS
	FDh	FreeDOS
	FFh	Microsoft, Phoenix

●31H
□プログラムの常駐終了
	IN  AH 31H
	    AL リターンコード(ERRORLEVEL)
	    DX メモリに常駐するプログラムのサイズ(パラグラフ単位)
	Ret なし

●32H
□DPB アドレスを取得
	IN  AH 32H
	    DL ドライブ番号 (0=ｶﾚﾝﾄ, 1=A, 2=B...)
	Ret AL 00H 成功 DS:BX DPB アドレス
	       FFH 失敗 (ドライブ番号が不正)

	DPB:
	00h	BYTE	Device ID
	01h	BYTE	論理ドライブ番号
	02h	WORD	nバイト/セクタ
	04h	BYTE	クラスタの最大セクタ番号
	05h	BYTE	クラスタを何回shiftすればセクタになるか
	06h	WORD	FATのある最初のセクタ番号
	08h	BYTE	FATのコピー数
	09h	WORD	ルートディレクトリエントリ数
	0Bh	WORD	データの記録されている最初のセクタ番号
	0Dh	WORD	全データクラスタ数 + 1 (0FF6h 以上なら FAT16)
	0Fh	BYTE	セクタ数/FAT
	10h	WORD	ディレクトリの最初のセクタ番号
	12h	DWORD	デバイスドライバヘッダのアドレス
	16h	BYTE	メディアＩＤ
	17h	BYTE	0=アクセスした FFh=していない
	18h	DWORD	次の DPB のアドレス

●33H
□ブレークチェックの制御
	・取得
		IN  AH 33H
		    AL 00H
		Ret DL 0 ブレークＯＦＦ
		       1 ブレークＯＮ
	・設定
		IN  AL 01H
		    DL 0 ブレークチェックＯＦＦ
		       1 ブレークチェックＯＮ
		Ret DL FFH以外 ブレークチェックの設定が行われた
		       FFH     ALの値が00H-01Hの範囲外
	・設定と取得
		[3.0+][内部]
		IN  AL 02H
		    DL 0 ブレークチェックＯＦＦ
		       1 ブレークチェックＯＮ
		Ret DL  0H ブレークＯＦＦ
		        1H ブレークＯＮ
		       FFH ALの値が00H-01Hの範囲外
		備考 この AL=2 のファンクションは DOS の内部スタックが
		     使用されない.

●33H
□05H ブートドライブ番号の取得
	[3.1+][us4.0+]
	IN  AH 33H
	    AL 05H
	Ret DL ドライブ番号(1=A,2=B...)

●33H
□06H 真の DOS バージョン取得
	[DOS 5.0+]
	IN  AH 33H
	    AL 06H
	Ret BL バージョン整数部 (メジャーバージョン)
	    BH バージョン小数部 (マイナーバージョン)
	    DL リビジョン
	    DH バージョンフラグ (b3: 1 DOS=ROM, b4: 1 DOS=HMA)
	    AL FFH [DOS 5.0] 真のバージョンである
	備考 SETVER されていても正常にバージョンを読み出せる.
	     OS/2 v2.1 は 20.10 を返す.
	     Windows NT DOS BOX は 5.50 を返す.

●34H
□InDOS flag アドレスを得る
	IN  AH 34H
	Ret ES:BX 1 byte の InDOS フラグアドレス
	備考 InDOS フラグは, DOS のファンクションコールが実行されている
	     ときに 1 増加し, DOS のファンクションコールが終了すると 1 
	     減少する. 
	     INT 28h が呼ばれている途中は, 0 の代わりに 1 になる. 

●35H
□割り込みベクタの読み出し
	IN  AH 35H
	    AL 割り込みベクタの番号
	Ret ES:BX 割り込みベクトル

●36H
□ディスクの残り容量の読み出し
	IN  AH 36H
	    DL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	Ret AX FFFFH     ドライブ番号が無効
	       FFFFH以外 １クラスタあたりのセクタ数
	    BX 使用可能なクラスタ数
	    DX １ドライブあたりのクラスタ数
	    CX １セクタ  あたりのバイト数

●37H
□スイッチキャラクタ取得・設定
	・取得
		IN  AH 37H
		    AL 00H
		Ret AL 00H 成功 DL スイッチキャラクタ
		       FFH 失敗 (or 未サポート)
	・設定
		IN  AH 37H
		    AL 01H
		    DL 新しく設定するスイッチキャラクタ
		Ret AL 00H 成功
		       FFH 失敗 (or 未サポート)

●38H
□国別情報の読み出し
	・情報を読み出す場合
	IN  AH 38H
	    AL 情報を得ようとする国のカントリーコード(FFH以外)
	       (00H=現在設定されている国 01=USA 51H=日本)
	    AL FFH(２バイトのカントリーコードを設定する場合)
	    BX カントリーコード(２バイト)
	    DS:DX 返される情報に対する32バイトのバッファの先頭アドレス
	Ret CF リセット 指定したバッファに国際適用業務に該当する情報がセット
			された
	       セット   指定された国のテーブルが存在しない
	・現在の国を変更する場合
	IN  AH 38H
	    AL 設定しようとする国のカントリーコード(FFH以外)
	    AL FFH(２バイトのカントリーコードを設定する場合)
	    BX カントリーコード(Ver3.1〜)
	    DX FFFFH

●39H
□サブディレクトリの作成
	IN  AH 39H
	    DS:DX パス名の先頭アドレス (ASCIZ)
	Ret CF 0 ディレクトリが作成された
	         AX 破壊
	       1 AX 03H パス名が無効またはパスが存在しない
		 AX 05H ルートディレクトリに空きディレクトリがないか, 
			既に同名のファイル又はディレクトリが存在する

●3AH
□サブディレクトリの削除
	IN  AH 3AH
	    DS:DX パス名の先頭アドレス (ASCIZ)
	Ret CF 0 ディレクトリを削除した
	         AX 破壊
	       1 AX 03H	パス名が無効またはパスが存在しない
	         AX 05H	指定したディレクトリが空ではなかったか, ディレクトリ
		 	ではなかったか, またはルートディレクトリであったため
			削除できなかった

●3BH
□カレントディレクトリの変更
	IN  AH 3BH
	    DS:DX パス名の先頭アドレス
	Ret CF 0 カレントディレクトリが変更された
	       1 AX 03H 指定したパスが無効またはパスが存在しない

●3CH
□ファイルの作成
	IN  AH 3CH
	    DS:DX パス名の先頭アドレス (ASCIZ)
	    CX ファイル属性
	Ret CF 0 AX ファイルハンドル
	       1 AX 03H	指定されたパスが無効またはパスが存在しない
	            05H 属性の指定が作成不可能なもの(ディレクトリ, ボリュー
			ムラベル)であった, または, ファイルを保護する属性が
			与えられた
	備考 すでにファイルが存在する場合はサイズが 0 byte になる.

●3DH
□既存ファイル／デバイスのオープン
	IN  AH 3DH
	    AL アクセス制御フラグ
	    DS:DX パス名の先頭アドレス (ASCIZ)
	Ret CF 0 AX ファイルハンドル
	       1 AX 01H	無効な機能コード
		    02H	ファイルが存在しない
		    03H 指定したパスが無効または存在しない
		    04H オープンされているファイルが多すぎる
			ファイルは作成されたが, アクセスのためのファイル・ハ
			ンドルに余裕がない, または内部システム領域に空き領域
			がない
		    05H ディレクトリ, ボリュームラベルをオープンしようとした, 
		    	または, 読み出し専用ファイルを書き込みようにオープン
			した
		    0CH アクセスコードが範囲(00H-02H)外だった
	
	アクセス制御フラグ:
	b2-b0 000 Read Only
	      001 Write Only
	      010 Read/Write
	      011 (DOS5〜) ?
	b3      0 (予約)
	b6-b4 シェアモード
	      000 互換モード
	      001 他から Read/Write 不可能
	      010 他から Write 不可能
	      011 他から Read 不可能
	      100 全て可能

●3EH
□ファイルのクローズ
	IN  AH 3EH
	    BX ファイルハンドル
	Ret CF 0 ファイルはクローズされた
	         AX 破壊
	       1 AX 06H 指定されたファイルハンドルは現在使用されていない

●3FH
□ファイル／デバイスからデータの読み出し
	IN  AH 3FH
	    DS:DX 入力バッファの先頭アドレス
	    CX 読み込むバイト数
	    BX ファイルハンドル
	Ret CF 0 AX 読み込まれたバイト数 (0 = EOF??)
	       1 AX 05H	指定されたファイルハンドルは読み出しが許可されてい
	    		ない
		 AX 06H 指定されたファイルハンドルは現在オープンされていな
		 	い
	備考 データは現在位置より読み込まれる. 読み込み後, 次回シーク位置が
	     更新される. 
	     CON デバイスよりデータを読む場合は, CR がくるまで読み込む. 

●40H
□ファイル／デバイスの書き込み
	IN  AH 40H
	    DS:DX 出力バッファの先頭アドレス
	    CX 読み込むバイト数
	    BX ファイルハンドル
	Ret CF 0 AX 書き込まれたバイト数
	       1 AX 05H	指定されたファイルハンドル書き込みが許可されていな
			い
		 AX 06H 指定されたファイルハンドルは現在オープンされていな
			い
	備考 CX が 0 の場合, データは何も書き込まれず, ファイルのサイズは
	     現在の位置になる.
	     戻り値の AX が CX より小さい場合は DISK が一杯である. 
	バグ DOS5-DOS6 では, 0 byte 書き込みをした際, ディスクが足りなくても
	     成功と返ってくるようである. 本当に成功したかは, 0 byte のファイ
	     ルシークをしてみれば判断できる. 

●41H
□ファイルの削除
	IN  AH 40H
	    DS:DX パス名の先頭アドレス (ASCIZ)
	Ret CF 0 ファイルは削除された
	         AX 破壊 (AL 削除されたファイルのあるドライブ?)
	       1 AX 02H ファイルは存在しない
	            03H 指定されたパスが無効または存在しない
		    05H 指定されたファイルが読み出し専用またはディレクトリで
			ある

●42H
□ファイル・ポインタの移動
	IN  AH 42H
	    CX:DX オフセット・バイト(CX*10000H+DX)
	    AL 00H ファイルの先頭からオフセット位置に移動する
	       01H 現在位置を中心にオフセット位置へ移動
	       02H ファイルの終わりからオフセット位置ずれた場所へ移動
	    BX ファイルハンドル
	Ret CF 0 DX:AX 移動されたファイル・ポインタのファイルの先頭からのオ
		       フセット
	    CF 1 AX 01H	ALレジスタの値が, 00H〜02H の範囲外である
		    06H 指定されたファイルハンドルは現在オープンされていな
			い
	備考 EOF を越えてファイル位置を変更した場合, 次回の書き込み時に
	     ファイルサイズが拡大する. 
	     このファンクションでファイルを 0 byte から非常に大きなサイズの
	     ファイルを作成使用とすると, いくつかのバージョンの DOS では, 
	     FAT が壊れることがある. 従って, 1 byte にしてからサイズを拡大
	     すべきである. 

●43H
□ファイル属性の読み込み／変更
	・属性を読み出す場合
		IN  AH 43H
		    AL 00H
		    DS:DX パス名の先頭アドレス (ASICZ)
		Ret CF 0 CX ファイル属性
		       1 失敗（下参照）
	・属性を設定する場合
		IN  AH 43H
		    AL 01H
		    DS:DX パス名の先頭アドレス (ASCIZ)
		    CX ファイル属性
		Ret CF 0 成功
		    CF 1 失敗（下参照）
	・共通  戻り値のCFが１の場合
	    CF 1 AX 01H ALの値が範囲外
	            03H 指定されたパスが無効または存在しない
		    05H 指定されたファイルに, 変更できないものがあった

●44H
□IOCTL:デバイスに対するI/Oコントロール
	・共通
	IN  AH 44H

	・IOCTL - デバイスデータを得る
	IN  AL 00H
	    BX ファイルハンドル
	Ret CF 0 DX デバイス情報
	         AX 破壊
	       1 AX エラーコード 01H,05H,06H（下記参照）
	備考
	デバイス情報:
	<キャラクタデバイス>
	 bit:
	  14	デバイスドライバは IOCTL リクエストを受け付ける
	  13	BUSY になるまで出力をサポート
	  11	OPEN/CLOSE をサポート
	   7	1 (デバイス)
	   6	EOF on input
	   5	raw (binary) mode
	   4	特殊デバイス (uses INT 29)
	   3	CLOCK デバイス
	   2	NUL デバイス
	   1	標準出力
	   0	標準出力
	<ディスクファイル>
	  15	[DOS 3.0+] ファイルはリモート上にある
	  14	[DOS 3.0+] ファイルを閉じるときに日付/時刻を変更しない
	  11	リムーバブルメディアではない
	   8	[DOS 4] READ で EOF超過時 か write で空きが無い場合致命的エラー
	   7	0 (ファイル)
	   6	ファイルは書き込まれていない
	  5-0	ドライブ番号 (0=A:, 1=B: ...)

	・IOCTL - デバイスデータをセットする
	IN  AL 01H
	    BX ファイルハンドル
	    DX デバイス・データ(DH=0)
	Ret CF 0 デバイス情報がセットされた
	備考 デバイスデータについては AL=0 デバイスデータを得る の
	     表のフォーマット. 

	・IOCTL - キャラクタデバイスより文字列を受け取る
	IN  AL 02H
	    BX ファイルハンドル
	    CX 受け取る/読みとるバイト数
	    DS:DX バッファの先頭アドレス
	Ret CF 0 AX 受け取った/読みとったバイト数
	       1 AX エラーコード 01H,05H,06H,0DH（下記参照）

	・IOCTL - キャラクタデバイスへ文字列を送る/書き込む
	IN  AL 03H
	    BX ファイルハンドル
	    CX 送る/書き込む文字列のバイト数
	    DS:DX バッファの先頭アドレス
	Ret CF 0 AX 書き込みが行われたバイト数
	       1 AX エラーコード 01H,05H,06H,0DH（下記参照）

	・IOCTL - 文字列をドライブ(ブロックデバイス)から受け取る/読みとる
	IN  AL 04H
	    BL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	    CX 文字列のバイト数
	    DS:DX バッファの先頭アドレス
	Ret CF 0 AX 読み込みが行われたバイト数
	       1 AX エラーコード 01H 05H 06H 0DH（下記参照）

	・IOCTL - 文字列をドライブ(ブロックデバイス)に送る/書き込む
	IN  AL 05H
	    BL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	    CX 文字列のバイト数
	    DS:DX バッファの先頭アドレス
	Ret CF 0 AX 書き込みが行われたバイト数
	       1 AX エラーコード 01H 05H 06H 0DH（下記参照）

	・IOCTL - 入力ステータスを得る
	IN  AL 06H
	    BX ファイルハンドル
	Ret CF 0 AL 00H	読み出しが行えない (not ready, EOF)
		    FFH	読み出しが行える
	       1 AX エラーコード 01H 05H 06H 0DH（下記参照）

	・IOCTL - 出力ステータスを得る
	IN  AL 07H
	    BX ファイルハンドル
	Ret CF 0 AL 00H 書き込みが行えない
		 AL 01H 書き込みが行える
	       1 AX エラーコード 01H 05H 06H 0DH（下記参照）

	・IOCTL - メディアの交換性
	[DOS 3.0+]
	IN  AL 08H
	    BL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	Ret CF 0 AX 00H	メディアが交換可能である(リムーバブル)
		 AX 01H メディアが交換不可能である
	       1 AX エラーコード 01H 0FH（下記参照）

	・IOCTL - リモート・ブロック・デバイスの検出
	[DOS 3.0+]
	IN  AL 09H
	    BL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	Ret CF 0 DX デバイス属性ワード
	            bit 15 1 SUBST が行われている
		        12 1 リモート (ネットワーク)
			   0 ローカル (直接接続)
			 9 1 直接 I/O 操作は不許可
	       1 AX エラーコード 01H 0FH（下記参照）
	備考 Microsoft 製 RAMDRIVE は DX = 0800h を返す.
	     それは 1 FAT, 1 ヘッド で固定ディスクである.

	・IOCTL - リモートハンドルの検出
	[DOS 3.1+]
	IN  AL 0AH
	    BX ファイルハンドル
	Ret CF 0 DX ファイルまたはデバイス属性ワード
		    bit 15  1 リモート (ネットワーク)
		            0 ローカル (直接接続)
		        14  1 日付と時刻を CLOSE 時に記録しない
	       1 AX エラーコード 01H 06H（下記参照）

	・IOCTL - リトライ回数の設定
	[DOS 3.1+]
	IN  AL 0BH
	    DX リトライの回数 (default 1)
	    CX リトライ間の待ち時間 (default 3)
	Ret CF 0 正常終了
	       1 AX エラーコード 01H（下記参照）
	備考 CX に設定するリトライ間の待ち時間は, プロセッサのスピードに影響
	     する. 内部では 65536 回の空ループを実行している. 

	・IOCTL - 一般的キャラクタデバイス要求
	[DOS 3.2+]
	IN  AL 0CH
	    BX ファイルハンドル
	    CH カテゴリーコード
	    CL 機能番号
	    DS:DX パラメータブロック
	Ret CF 1 AX エラーコード
	       0 成功 DS:DX CL が 65H だったとき,  iteration count
	備考
	カテゴリーコード:
	00h	unknown
	01h	COMx:
	03h	CON
	05h	LPTx:
	9Eh	STARLITE
	00h-7Fh	(予約/Microsoft)
	80h-FFh (予約/OEM, user)
	機能番号:
	45h	巡回(リトライ)カウント設定
	4Ah	コードページ選択
	4Ch	コードページ準備開始
	4Dh	コードページ準備終了
	5Fh	[DOS 4.0+] ディスプレイ情報設定
	65h	巡回(リトライ)カウント取得
	6Ah	選択済みコードページ問い合わせ
	6Bh	準備リスト問い合わせ
	7Fh	[DOS 4.0+] ディスプレイ情報取得
	詳しくは Interrupt List E を参照のこと. 

	・IOCTL - 一般的ブロックデバイス要求
	[DOS 3.2+]
	IN  AL 0Dh
	    BL ドライブ番号 (0=ｶﾚﾝﾄ, 1=A, 2=B ...)
	    CH カテゴリーコード
	    CL 機能コード
	    DS:DX [DOS] パラメータブロック
	    SI:DI [OS/2 DOS BOX] パラメータブロック
	Ret CF 1 AX エラーコード 01H,02H（下記参照）
	       0 DS:DX CL 60H データブロック
	                  61H 〃
	備考
	カテゴリーコード:
	08h	ディスクドライブ
	00-7Fh	(予約 Microsoft)
	80-FFh	(予約 OEM/user)
	機能コード:
	40h	デバイスパラメータ設定
	41h	論理デバイス トラック書き込み
	42h	論理デバイス トラックフォーマット&ベリファイ
	46h	[DOS 4.0+] ボリュームシリアル番号設定
	47h	(DOS 4.0+) アクセスフラグ設定
	48h	[Enh. Disk Drive Spec] メディアロック状態設定
	49h	[Enh. Disk Drive Spec] ドライブのメディアイジェクト
	4Ah	[MS-DOS 7.0] 論理ボリュームロック
	4Bh	(MS-DOS 7.0) 物理ボリュームロック
	50h	[PCMCIA] 絶対メモリ書き込み
	51h	[PCMCIA] 共通メモリ書き込み
	52h	[PCMCIA][DOS 5+?] 強制メディア交換
	53h	[PCMCIA] ドライブ消去
	54h	[PCMCIA] メディア消去
	56h	[PCMCIA] 消去ステータスコールバック設定
	57h	[PCMCIA] カード情報構造体(CIS)追加 tuple
	58h	[PCMCIA] CIS消去 tuples
	60h	デバイスパラメータ取得
	61h	論理デバイス トラック読み込み
	62h	論理デバイス トラックベリファイ
	66h	[DOS 4.0+] ボリュームシリアル番号取得
	67h	[DOS 4.0+] アクセスフラグ取得
	68h	[DOS 5.0+] メディアタイプセンス
	6Ah	[MS-DOS 7.0] 論理ボリュームアンロック
	6Bh	[MS-DOS 7.0] 物理ボリュームアンロック
	6Ch	[MS-DOS 7.0] ロックフラグ取得
	6Dh	[MS-DOS 7.0] オープン済みファイル列挙?
	6Eh	[MS-DOS 7.0] スワップファイル検索
	6Fh	[MS-DOS 7.0] ドライブマップ情報取得
	70h	[PCMCIA] 属性メモリ読み込み
	70h	[MS-DOS 7.0] 現在のロック状況取得
	71h	[MS-DOS 7.0] 最初のクラスタ取得
	73h	[PCMCIA][DOS 5+?] メモリメディア情報取得取得
	76h	[PCMCIA] 消去ステータスコールバック取得
	77h	[PCMCIA] 最初のカード情報構造体取得 tuple
	78h	[PCMCIA] 次のカード情報構造体取得 tuple
	7Fh	[PCMCIA] 不明の情報取得
	詳しくは Interrupt List E を参照. 

	・IOCTL - 論理ドライブマップ取得
	IN  AL 0EH
	    BL ドライブ番号 (0=ｶﾚﾝﾄ, 1=A, 2=B ...)
	Ret CF 0 AL 0 このブロックデバイスは 1 つの論理ドライブに接続. 
	            1-26 ドライブを参照するために, 最後の文字が使われている. 
	備考 よくわからん. Interrupt List を見てくれ. 

	・IOCTL - 論理ドライブマップを設定
	IN  AL 0FH
	    BL 物理ドライブ番号 (0=ｶﾚﾝﾄ, 1=A, 2=B ...)
	Ret CF 0 成功 現在応答したドライブが次の論理ドライブに
	       1 AX エラーコード 01H,0FH（下記参照）
	備考 よくわからん. Interrupt List を見てくれ. 

	・共通
	 戻り値のCFが1でエラーの場合. 
	 括弧内は, そのエラーの起こる可能性がある機能(ALの番号)を示す
	AX 00H (00H,01H,02H,03H,04H,05H,06H,07H)
		無効な機能コード
	   01H (08H)
		デバイスドライバがこの機能をサポートしていない
	   05H (04H,05H,06H,07H)
		アクセスが拒否された
	   06H (00H,01H,02H,03H,06H,07H)
		指定されたファイルハンドルは現在オープンされていない
	   0DH (06H,07H)
		指定されたデバイス情報が無効である
	   0FH (08H)
		指定されたデバイス番号が無効である

●45H
□ファイルハンドルのコピー
	IN  AH 45H
	    BX コピー元ファイルハンドル
	Ret CF 0 AX コピーされた新しいファイルハンドル
	       1 AX 04H オープンされているファイルが多すぎる
		    06H 指定されたファイルハンドルは現在オープンされてい
			ない

●46H
□指定したファイルハンドルへのコピー
	IN  AH 46H
	    BX コピー元ファイルハンドル
	    CX 新規作成ファイルハンドル
	Ret CF 0 成功
	       1 AX 04H オープンされているファイルが多すぎる
		    06H 指定されたファイルハンドルは現在オープンされてい
			ない
	備考 CX で示したファイルハンドルが既に使われている場合は, 強制的に
	     閉じられる. 
	     DOS 3.30 で BX=CX だったら, ハングアップする. 

●47H
□カレントディレクトリの読み出し
	IN  AH 47H
	    DS:SI 返される情報に対する64バイトのバッファの先頭アドレス
	    DL ドライブ番号(0=ｶﾚﾝﾄ,1=A,2=B...)
	Ret CF 0 成功 DS:SI ｶﾚﾝﾄディレクトリ (ASCIZ)
	              AX [UNDOC] 0100H
	       1 AX 0FH ドライブ番号が無効である(バッファの内容は変更されな
			い)
	備考 返却値には ドライブまたは最初のバックスラッシュ(円記号)は無い. 

●48H
□メモリブロックの割り当て
	IN  AH 48H
	    BX 割り当てを要求するメモリブロックのパラグラフサイズ
	Ret CF 0 AX 割り当てられた領域のパラグラフ番号(セグメントアドレス)
	       1 AX 07H	メモリ・コントロールブロックが破壊されている
	            08H 充分な大きさのメモリがない
			BX 割り当て可能な最大メモリ領域のパラグラフサイズ

●49H
□メモリブロックの解放
	IN  AH 49H
	    ES 開放するメモリ領域のパラグラフ番号(セグメントアドレス)
	Ret CF 0 成功
	       1 AX 07H	メモリ・コントロールブロックが破壊されている
	            09H 指定された領域はメモリアロケーションによって割り当て
			られたものではない
	備考 07h はおそらく返ってこない. 

●4AH
□メモリブロックのサイズの変更
	IN  AH 4AH
	    ES メモリ領域のパラグラフ番号(セグメントアドレス)
	    BX 新たなメモリ領域のパラグラフサイズ
	Ret CF 0 成功
	       1 AX 07H	メモリ・コントロールブロックが破壊されている
	            08H 充分な大きさのメモリがない
			BX 割り当て可能な最大メモリ領域のパラグラフサイズ
	            09H 指定された領域はメモリアロケーションによって割り当て
			られたものではない

●4BH
□プログラムのロードと実行
	IN  AH 4BH
	    AL 00H
	    DS:DX プログラムのパス名の先頭アドレス (ASCIZ)
	    ES:BX パラメータ・ブロック(*)の先頭アドレス
	    AL 00H プログラムのロード, 実行 (PSP作成)
	       01H プログラムのロード (ver5〜)
	       03H プログラムのロード (PSP非作成/オーバーレイ)
	Ret CF 0 成功(05HはRet無し)
	       1 AX 02H	ファイルが存在しない
	            03H 指定されたパスが無効またはパスが存在しない
		    08H 充分な大きさのメモリがない
		    1AH 環境変数が32kバイト以上ある
		    0BH EXEファイルのヘッダが不正
	備考 DOS 2 では SS:SP を含め, 全てのレジスタが破壊される. 
	     AL = 1 では, AX が 子プロセスのスタックトップに積まれる. 
	     AL = 3 では, DOS は 呼び出し側によってメモリは確保されていると
	     仮定している. 
	     DOS はプログラムファイルの先頭 2 bytes を読み取り, それが 'MZ'
	     なら .EXE ファイルであると仮定し, そうでなければ .COM ファイル
	     であると仮定する. 
	パラメータブロック:
		00h	WORD	コピーする環境セグメントアドレス
		02h	DWORD	コピーするコマンドラインへのアドレス
		06h	DWORD	第１ＰＳＰへコピーするＦＣＢへのアドレス
		0Ah	DWORD	第２ＰＳＰへコピーするＦＣＢへのアドレス
		0Eh	DWORD	(AL=01h) 初期 SS:SP ?
		12h	DWORD	(AL=01h) 初期 CS:IP ?
	パラメータブロック: (AL=3)
		00h	WORD	ファイルをロードするセグメントアドレス
		02h	WORD	イメージに対して使用される再配置因子

●4BH
□05H プログラムの実行準備
	IN  AH 4BH
	    AL 05H 新しいプログラムの実行準備
	    DS:DX EXECSTATE*構造体のアドレス(AL=05H)
	Ret CF 0 成功 AX 0
	       1 失敗 AX エラーコード

●4CH
□プロセスの終了
	IN  AH 4CH
	    AL リターンコード(子プロセスが親プロセスへ渡す１バイトのデータ)
	Ret なし
	備考 このプロセスが開いたファイルは全て閉じられ, 確保したメモリは
	     全て解放される. 
	     ネットワーク機能で LOCK したファイルは前もって UNLOCK しな
	     ければならない. 

●4DH
□子プロセスの終了コードの読み出し
	IN  AH 4DH
	Ret AL 子プロセスからのリターンコード
	    AH 終了の仕方
	       00H 通常 (INT 21H-4CH, INT 20H, JMP 0)
	       01H [CTRL]+[C]による終了 (INT 23H)
	       02H 致命的エラー (INT 24H)
	       03H 常駐したまま終了(INT 27H,ファンクション31H)
	備考 このファンクションを実行すると, DOS は値を 0 にしてしまう. 
	     従って, COMMAND.COM より起動した際は, 値を読むことは出来ない. 

●4EH
□最初に一致するファイルの検索
	IN  AH 4EH
	    DS:DX パス名の先頭アドレス
	    CX ファイル属性マスク
	Ret CF 0 DTAに検索されたファイルの情報が書き込まれる
	       1 AX 02H	ファイルが存在しない
	            03H パスが見付からない
	            12H これ以上ファイルが存在しない

●4FH
□次に一致するファイルの検索
	IN  AH 4FH
	    DS:DX パス名の先頭アドレス
	    CX ファイル属性
	Ret CF 0 DTAに検索されたファイルの情報が書き込まれる
	       1 AX 12H	これ以上ファイルが存在しない

●50H
□カレントＰＳＰ設定
	IN  AH 50H
	    BX 新しく設定するPSPのセグメントアドレス
	参考 DOSはファイル操作やメモリ操作にPSPを使うので, INT 28H 中等で
	     ファイル操作等を行う場合, この呼び出しを用いてPSPを自分の
	     プロセスのPSPに設定し直す必要がある. またその場合は, ファイル
	     操作等完了後は再び元のPSPに戻す必要がある. 

●51H
□カレントＰＳＰ取得
	IN  AH 50H
	Ret BX カレントPSPセグメントアドレス
	参考 INT 21H Func.52H

●52H
□IO.SYS の内部ワークエリアアドレスを取得(DOS 2/Undoc)
	IN  AH 52H
	Ret ES:BX DOSワークエリアのあるアドレス
	          ES "DOS DATA"のセグメントアドレス
	参考
	ES:[BX-02] 2 最初の MCB のセグメントアドレス
	  :[BX     4 最初の DPB のアドレス(OFF:SEG)
	      +04  4 File System Tabel のアドレス(OFF:SEG)
	      +08  4 CLOCK$ デバイスヘッダアドレス(OFF:SEG)
	      +0C  4 CON デバイスヘッダアドレス(OFF:SEG)
	      +10  1 DOS 2:論理デバイス数/DOS 3:ブロックデバイス数
	      +11  2 任意のデバイスの最大クラスタサイズ
	      +13  4 最初の DISK BUFFER のアドレス(OFF:SEG)
	      +17 18 DOS 2:NUL デバイスヘッダ(not address)
	      ------- DOS 3.0 -----
	      +17  4 DOS 3:カレントディレクトリ構造体のアドレス
	      +1B  1 LASTDRIVE
	      +22  4 最初のFCBのアドレス(OFF:SEG)
	      +28 18 DOS 3:NUL デバイスヘッダ(not address)

●53H
□BIOS パラメータブロックよりDPBを得る(?)
	IN  AH 53H
	    DS:SI BIOS PARAMETER BLOCK
	    ES:BP DPB 格納バッファ
	Ret ES:BP DPB の内容

●54H
□ベリファイフラグの読み出し
	IN  AH 54H
	Ret AL 現在のベリファイフラグの値(0=OFF 1=ON)

●55H
□子プロセスPSP作成
	[内部]
	IN  AH 55H
	    DX 新規PSPを作成するセグメント
	    SI [DOS 3.0+] 
	Ret AL 破壊
	備考 子プロセスのPSPを作成する. 親プロセスは自分になる. 

●56H
□ディレクトリ・エントリの移動（パス名変更）(DOS 2+)
	IN  AH 56H
	    DS:DX パス名の先頭アドレス (ASCIZ)
	    ES:DI 移動先のパス名の先頭アドレス (ASCIZ)
	Ret CF 0 成功
	       1 AX 02H	DS:DXで指定されたファイルが存在しない
	            03H 指定されたパスが無効または存在しない
		    05H DS:DXで指定されたパス名がディレクトリであったかES:DI
			で指定したファイルが既に存在している
		    11H 違うドライブ間で移動しようとした
	備考 アーカイブビットはセットされない. 
	     オープンされているファイルは名前を変更すべきではない. 

●57H
□ファイルの時間情報の読み出し／設定
	・共通
		IN  AH 57H
	・日付／時刻を得る (DOS 2+)
		IN  AL 00H
		    BX ファイルハンドル
		Ret CF 0 DX/CX ファイルが最後に更新された日付／時刻
	・日付／時刻を設定する (DOS 2+)
		IN  AL 01H
		    BX ファイルハンドル
		    CX セットする時刻
		    DX セットする日付
		Ret CF 0 成功(ファイルがクローズされるまで記録されない)
	・最終アクセス日取得 (DOS 7,Windows95)
		IN  AL 04H
		    BX ファイルハンドル
		Ret CF 0 成功
		         DX 最終アクセス日付
		         CX 最終アクセス時刻
		    CF 1 失敗
		         AX エラーコード
	・最終アクセス日設定 (DOS 7,Windows95)
		IN  AL 05H
		    BX ファイルハンドル
		    CX 最終アクセス時刻=0000h (機能してない)
		    DX 最終アクセス日付
		Ret CF 0 成功
		       1 失敗
		         AX エラーコード
	・ファイル作成日時取得 (DOS 7,Windows95)
		IN  AL 06H
		    BX ファイルハンドル
		Ret CF 0 成功
		         CX ファイル作成時刻
		         DX ファイル作成日付
		         SI ファイル作成時刻 10ms単位時間 (0-199) (?)
		       1 失敗
		         AX エラーコード
	・ファイル作成日時設定 (DOS 7,Windows95)
		IN  AL 07H
		    BX ファイルハンドル
		    CX ファイル作成時刻
		    DX ファイル作成日付
		    SI ファイル作成時刻 10ms単位時間 (0-199) (?)
		Ret CF 0 成功
		       1 失敗
		         AX エラーコード
	・共通  CFが1のエラーの場合
		AX 01H ALレジスタの値が範囲外
		   06H 指定されたファイルハンドルは現在オープンされていない

●58H
□メモリ割り当て方法・UMB接続状況の設定／取得
	・共通
		IN  AH 58H
		
	・ストラテジを取得 (DOS 2.11)
		IN  AL 00H
		Ret CF 0 AX ストラテジ(00H:下位 01H:最小 02H:上位 資料２を参照)
		       1 ALの値が無効
	・ストラテジを設定 (DOS 2.11)
		IN  AL 01H
		    BL ストラテジ(00H:上位 01H:最小 02H:上位 資料２を参照)
		    BH [DOS 5.0+] 00h
		Ret CF 0 成功
		       1 ALの値が無効または設定したストラテジが範囲外である
	・UMB 接続状況取得
		IN  AL 02H
		Ret AL 00H UMBはコンベンショナルメモリと接続していない
		       01H UMBはコンベンショナルメモリと接続している
	・UMB 接続状況設定
		IN  AL 03H
		    BX 接続状況 (0H 切り放す, 1H 接続)
		Ret CF 0 成功
		       1 失敗
		         AX 01H 

●59H
□拡張エラーコードの取得
	[DOS 3.0+]
	IN  AH 59H
	    BX 0000H
	Ret AX 拡張エラーコード
	    BH エラークラス
	    BL 可能な対処
	    CH エラーの発生箇所
	    ES:BI おそらくエラーコードリストへのアドレス
	    CL,DX,SI,DI,BP,DS,ES 破壊

●5AH
□テンポラリファイルの作成(Ver3.1〜)
	[DOS 3.0+]
	IN  AH 5AH
	    CX ファイル属性
	    DS:DX パス名の先頭アドレス(パス名の後ろに13バイトのファイル名を
	          格納する領域を確保する必要がある)
	Ret CF 0 AX ファイルハンドル
	            DS:DX 作成されたファイルのパス名
	       1 AX 03H	指定したディレクトリが無効または存在しない
	            04H オープンされているファイルが多すぎる
	            05H アクセスが拒否された
	備考 MS-DOS 5.0 Revision A, B と PC-DOS 5.00 Revision A では, ディレ
	     クトリがルートでディスクに空きがない場合, ハングアップする. 
	     DOS 6.2 でパスセパレータが 2 個連続しているとハングアップする
	     らしい.
	     MS-DOS 3.0 〜 4.0 では現在日時と時刻を元にした 16 進数のファイ
	     ル名になるようだ. 
	     MS-DOS 6.0 〜 は A〜P の文字を 16 真数に使っているようだ. 

●5BH
□新規ファイルの作成(Ver3.1〜)
	[DOS 3.0+]
	IN  AH 5BH
	    CX ファイル属性
	    DS:DX パス名の先頭アドレス
	Ret CF 0 AX ファイルハンドル
	       1 AX 03H 指定されたディレクトリが無効または存在しない
	            04H カレントプロセス中に利用可能なハンドルがないか, ま
			たはMS-DOSのシステムテーブルに余裕がない
		    05H 属性の指定が作成不可能なもの(ディレクトリ, ボリュー
			ムラベル)が入っていたか, または同じ名前のディレクト
			リが存在した
		    50H DS:DXで指定したファイルがすでに存在する

●5CH
□[SHARE]レコードをロック・アンロック
	[SHARE][DOS 3.0+]
	IN  AH 05CH
	    AL 00H ロック
	       01H アンロック
	    BX ファイルハンドル
	    CS:DX ロックするファイルの先頭からのオフセット
	    SI:DI ロックする長さ(bytes)
	Ret CF 0 成功
	       1 失敗
	         AX 01H  ファンクションコードが無効
	         06H  ハンドルが無効
	         21H  ロックされている
	         24H  シェアリングバッファが溢れた

●5FH
□ドライブ存在問い合わせ
	・存在するか
		IN  AH 05FH
		    AL 007H
		    DL ドライブ番号 (0=A: 1=B: ...)
		Ret CF 0 存在する
		       1 しない
		         AX 0FH ドライブ名が無効
	・存在しないか
		IN  AH 05FH
		    AL 008H
		    DL ドライブ番号 (0=A: 1=B: ...)
		Ret CF 0 存在する
		       1 しない
		         AX 0FH ドライブ名が無効

●60H
□真のファイル名を得る
	[DOS 3.0+]
	IN  AH 60H
	    DS:SI ASCIIZ ファイル名
	    ES:DI 帰ってくるファイル名の格納エリア(128bytes)
	Ret CF 1 失敗
	         AX 02H ファイルが見付からない
		    03H パス名が見付からない
	       0 成功
	         AL 破壊
	         ES:DI 真のファイル名
	参考 文字中に [.] や [..] が含まれている, JOIN や SUBST されている
	     場合に, 真のファイル名を返します. ネットワークドライブ上のファ
	     イル名も正規化されます. 

●61H
□(予約済み)

●62H
□カレントＰＳＰの取得
	[DOS 3.0+]
	IN  AH 62H
	Ret BX カレントプロセスのＰＳＰのセグメントアドレス
	備考 DOS 内部のスタックを使用しない. 

●67H
□オープン可能な最大ハンドル数の設定
	[DOS 3.3+]
	IN  AH 67H
	    BX 設定する最大ハンドル数
	Ret CF 0 正常
	       1 エラー
	備考 NECの 3.3 は使用不可(内部 Version が 3.21 のため)

●68H
□ファイルのフラッシュ
	IN  AH 68H
	    BX ファイルハンドル
	Ret CF 0 成功
	       1 エラー
	備考 DOS内部のDISKバッファはディスクへ書き込まれ, ディレクトリ
	     エントリは更新される. 

●69H
□ディスクシリアル番号設定・取得
	IN  AH 69H
	    AL 00H=取得, 01H=設定
	    BL ドライブ番号 (0=ｶﾚﾝﾄ, 1=A, 2=B...)
	    BH レベル (00H=DOSのみ  他=OS/2)
	    DS:DX ディスク情報（資料２を参考）
	Ret CF 0 成功
	         AX 破壊
	       1 失敗
	         AX エラーコード
	備考 致命的エラーは発生しない. ネットワークデバイスに対しては無効. 

●6CH
□拡張ファイルオープン／新規作成
	[DOS 4.0+]
	IN  AH 6CH
	    AL 00H
	    BL オープンモード (AH=3DH INT 21H のファイルオープンと同じ)
	    BH フラグ
	       bit 6: 全ての書き込みを自動フラッシュ
	           5: INT 24H するかわりにエラーコードを返す
	    CX 新規作成時の属性
	    DL ファイルが存在するとき/しないときの動作設定
	    DH 00H(予約)
	    DS:SI ファイル名 (ASCIZ)
	Ret CF 1 AX エラーコード
	       0 AX ファイルハンドル
	         CX ステータス
	備考
	CXの戻り値:
	01H	ファイルはオープンされた
	02H	ファイルは新規作成された
	03H	ファイルは置き換えられた
	DLに設定する動作:
	bit	Description	(Table 1073)
	 7〜4	ファイルが存在しない場合の動作指定
		0000 失敗
		0001 新規作成
	 3〜0	ファイルが存在する場合の動作指定
		0000 失敗
		0001 開く
		0010 置き換えで開く (Truncate)

----------------------------------------------------------------------------
□ファンクションコールの簡単な分類

 1文字入力
             01H 表示有り. CTRL+C チェック有り.
             08H 表示無し. CTRL+C チェック有り.
             07H 表示無し. CTRL+C チェック無し.
             06H 表示無し. CTRL+C チェック無し.
 1文字出力
             02H CTRL+C チェック有り.
             06H CTRL+C チェック無し.
 文字列入力
             0AH CTRL+C チェック有り. テンプレート利用及び漢字変換可.
 文字列出力
             09H '$' までの文字列出力.
 キーバッファ
             0CH キーバッファをクリアし各リクエスト(1H,6H,7H,8H,0AH)実行.
             0BH キーバッファ内の文字の有無を取得.
 ドライブ・ディスク
             0DH ディスクのリセット
             0EH カレントドライブの設定.
             19H カレントドライブの取得.
             1BH カレントドライブの情報取得.
             1CH ドライブの情報取得.
             36H ディスク残り容量の取得.
             2EH ベリファイフラグの設定.
             54H ベリファイフラグの状態取得.
             69H ディスクシリアル番号設定・取得.
 ディレクトリ
             11H 最初のディレクトリサーチ.
             12H 次のディレクトリサーチ.
             39H サブディレクトリ作成.
             3AH サブディレクトリ削除.
             47H カレントディレクトリ取得.
             3BH カレントディレクトリ変更.
             56H ディレクトリエントリの移動(ファイル名変更, ディレクトリ間移動)
 ファイル操作
             3CH ファイルの作成.         ファイルハンドルが返される.
             5AH テンポラリファイル作成. ファイルハンドルが返される.
             5BH 新規ファイル作成.       ファイルハンドルが返される.
             41H ファイルの削除. 
             43H ファイル属性の取得/変更.
             6CH 拡張ファイルオープン    ファイルハンドルが返される.
 ファイル内容操作 (ファイルハンドル)
             3DH 既存ファイル・デバイスのオープン.
             3EH ファイル・デバイスのクローズ.
             3FH ファイル・デバイスの読み出し.
             40H ファイル・デバイスに書き込み.
             42H ファイルポインタを移動.
             45H ファイルハンドルを複写作成.
             46H ファイルハンドルを既存のファイルハンドルにコピー.
             57H ファイルの更新日時取得/設定.
             44H デバイスに対するコントロール.
             67H オープン可能なファイルハンドル数の設定.
             68H ファイルのフラッシュ
             6CH 拡張ファイルオープン／新規作成
 ファイル操作 (FCB)
             1AH DTA のアドレス設定.
             2FH DTA のアドレス取得.
             4EH 一致するファイルの検索.
             4FH 次に一致するファイルの検索.
 メモリ
             48H メモリブロックの割り当て.
             49H メモリブロックの開放.
             4AH メモリブロックのサイズ変更.
             58H メモリ割り当て方法の設定.
 プロセス
             00H プログラムの終了.
             4CH プログラムの終了.
             31H プログラムを常駐終了.
             4BH プログラムのロードと実行.
             4DH 子プロセスのリターンコード読み出し.
             50H カレントPSPの設定.
             51H カレントPSPの取得.
             62H PSP の取得.
 時間情報
             2AH 日付を取得.
             2BH 日付を設定.
             2CH 時刻を取得.
             2DH 時刻を設定.
 割り込み
             25H ベクタのベクタアドレスを設定.
             35H ベクタのベクタアドレスを取得.
 ステータス
             30H DOSのバージョン番号を取得.
             33H [CTRL]+[C] (BREAK) の状態を取得/設定.
             38H 国別情報を取得.
             52H IO.SYS ワークエリアアドレスを得る.
             59H 拡張エラー情報の取得.

============================================================================
       資料２  ＤＯＳファンクションコールで使用するパラメータの説明
============================================================================

◎以下のものを説明します

				使用する機能
ファイル名解析制御ビット	29H
ファイル番号			ファイルハンドル使用するもの全て
検索されたファイルの情報	4EH,4FH
ファイル属性			3CH,43H,5BH
パラメータブロック		4BH
EXECSTATE構造体			4BH
入力用バッファ			?
アクセスコード			3DH
ストラテジの意味		58H
ＭＣＢ				(52H)

----------------------------------------------------------------------------
□ファイル名解析の制御ビット

bit 値 説明
 0   0 ﾌｧｲﾙの区切り記号を検出した場合は全ての解析を停止させる
     1 先行する区切り記号は無視する
 1   0 文字列にﾄﾞﾗｲﾌﾞ番号が入っていない場合FCBのﾄﾞﾗｲﾌﾞ番号には00hが入る
     1 文字列にﾄﾞﾗｲﾌﾞ番号が入っていない場合FCBのﾄﾞﾗｲﾌﾞ番号は変更されない
 2   0 文字列にﾌｧｲﾙ名が入っていない場合FCBのﾌｧｲﾙ名には8つのｽﾍﾟｰｽがｾｯﾄされる
     1 文字列にﾌｧｲﾙ名が入っていない場合FCBのﾌｧｲﾙ名は変更されない
 3   0 文字列に拡張子が入っていない場合FCBの拡張子には3つのｽﾍﾟｰｽがｾｯﾄされる
     1 文字列に拡張子が入っていない場合FCBの拡張子は変更されない

----------------------------------------------------------------------------
□ファイル番号(FILES=5)

ﾌｧｲﾙﾊﾝﾄﾞﾙ 名称  ﾃﾞﾊﾞｲｽ名 Ｃ言語 COMMAND.COM     プログラム
 0	標準入力     CON stdin  ﾘﾀﾞｲﾚｸﾄ可能	ﾘﾀﾞｲﾚｸﾄ可能
 1	標準出力     CON stdout ﾘﾀﾞｲﾚｸﾄ可能	ﾘﾀﾞｲﾚｸﾄ可能
 2	標準ｴﾗｰ出力  CON stderr ﾘﾀﾞｲﾚｸﾄ不可能	ﾘﾀﾞｲﾚｸﾄ可能
 3	標準補助装置 AUX stdaux ﾘﾀﾞｲﾚｸﾄ可能	ﾘﾀﾞｲﾚｸﾄ可能
 4	標準プリンタ PRN stdprn ﾘﾀﾞｲﾚｸﾄ可能	ﾘﾀﾞｲﾚｸﾄ可能
 5〜	ユーザー用


----------------------------------------------------------------------------
□検索されたファイルの情報

DTA + ｵﾌｾｯﾄ	 | 情報の内容
-----------------+-------------------------------------
DTA + 00H	 | 検索するファイルの属性
DTA + 01H	 | ドライブ番号(0=A,1=B...)
DTA + 02H〜 +09H | 検索するパス名の中のファイル名
DTA + 0AH〜 +0CH | 検索するパス名の中の拡張子
DTA + 0DH〜 +14H | システム予約
DTA + 15H	 | 検索されたファイルの属性
DTA + 16H〜 +17H | Time
DTA + 18H〜 +19H | Date
DTA + 1AH〜 +1DH | ファイルの大きさ
DTA + 1EH〜 +2AH | パックトネーム(Packed name)(ASCIZ文字列)
		 |  (ファイル名が８文字未満の場合に, スペースが除かれた物)
Packed Name:
ABC     .XYZ → ABC.XYZ[00h]

----------------------------------------------------------------------------
□ファイル属性

  +--+--+--+--+--+--+--+--+
  |b7|b6|b5|b4|b3|b2|b1|b0|
  +--+--+--+--+--+--+--+--+
         ア デ ボ シ 不 読
         ｜  ｲ リ ス 可 込
         カ レ  ﾕ テ 視 専
         イ ク ｜ ム    用
         ブ ト ム         
	    リ

----------------------------------------------------------------------------
□パラメータブロック

  AL=00Hの場合
 ｵﾌｾｯﾄ  ｻｲｽﾞ    内容
   00h 1 WORD 環境のセグメントアドレス
   01h 2 WORD PSPのｵﾌｾｯﾄ80Hに作成されるｺﾏﾝﾄﾞﾗｲﾝに与える80ﾊﾞｲﾄのﾃﾞｰﾀのﾎﾟｲﾝﾀ
   03h 2 WORD PSPのｵﾌｾｯﾄ5CHに作成されるﾃﾞﾌｫﾙﾄFCBに与える10Hﾊﾞｲﾄのﾃﾞｰﾀのﾎﾟｲﾝﾀ
   05h 2 WORD PSPのｵﾌｾｯﾄ6CHに作成されるﾃﾞﾌｫﾙﾄFCBに与える10Hﾊﾞｲﾄのﾃﾞｰﾀのﾎﾟｲﾝﾀ

  AL=03Hの場合
  +00h 1 WORD ファイルをロードするセグメントアドレス
  +02h 1 WORD イメージに対して使用される再配置因子

----------------------------------------------------------------------------
□EXECSTATE構造体

	esReserved	WORD	渡される環境のセグメント
	esFlags		WORD	タイプ・フラグ
				bit 0 プログラムは .EXE である
				BIT 1 プログラムはオーバーレイである
	esProgName	DWORD	プログラム名のアドレス
	esPSP		WORD	プログラムの PSP セグメント
	esStartAddr	DWORD	プログラムの CS:IP の初期値
	esProgSize	DWORD	PSPを 含めたプログラムサイズ

----------------------------------------------------------------------------
□入力用バッファ

 バッファ先頭バイト
 ｜
 ↓    0    1    2    3             m    m+1      ｎ-1  ｎ
+----+----+----+----+----+--------+----+----+----+----+----+
| ｎ | (m)|ch-1|ch-2|ch-3|…………|ch-m| CR |……|    |    |
+----+----+----+----+----+--------+----+----+----+----+----+

ｎ…CRも含めた最大バッファ長. ユーザーがセットする必要がある
(m)…入力された文字数. CRは含まない. この場合, 最大ｎ-1文字, 最小0文字となる. 
      （システムコール側がセットする）

----------------------------------------------------------------------------
□アクセスコード

ﾋﾞｯﾄ 3210
     0000 読み出し
     0001 書き込み
     0010 読み出し＆書き込み

----------------------------------------------------------------------------
□ストラテジの意味

ｽﾄﾗﾃｼﾞ    意味
00H    最も下位に位置するメモリブロック (first fit)
01H    必要最小のメモリブロック         (best fit)
02H    最も上位に位置するメモリブロック (last fit)

ver5以降

40H    最下位  のUCBを割当てる
41H    最小ｻｲｽﾞのUCBを割当てる
42H    最上位  のUCBを割当てる
80H    最下位  のUCB or MCBを割当てる
81H    最小ｻｲｽﾞのUCB or MCBを割当てる
82H    最上位  のUCB or MCBを割当てる

----------------------------------------------------------------------------
□ＭＣＢ

      +------------------+ 'M'=後続するメモリブロックが存在する
   +00|マーク('M'or'Z')*1| 'Z'=最後のメモリブロックである
      +------------------+
   +01|  オーナーＩＤ    |このメモリブロックを使用するプロセスのプロセスＩＤ(=
      |                  |PSPのｾｸﾞﾒﾝﾄｱﾄﾞﾚｽ). 0ならフリーエリア
      +------------------+
   +03|  サイズ          |メモリブロックの大きさ（パラグラフ単位）
      |（パラグラフ単位）|ＭＣＢ自身は含まれない
      +------------------+
   +05|   Reserved       |３バイト, 予約
      +------------------+
   +08| オーナー名       |ASCIZのプロセス名(DOS5以降).実行中のファイル名等.
      |（ASCIZ）         |'SC'=System Code (ｼｽﾃﾑが使用.VRAM,ROM,SCSI-BIOS等)
   +15|                  |'SD'=System Date (後にSCBが続く.FILES,BUFFERS等)
      +------------------+

----------------------------------------------------------------------------

□ディスク情報

ｵﾌｾｯﾄ
 +00h    WORD   0
 +02h    DWORD  シリアルナンバー
 +06h 11 BYTEs  ボリュームラベル
 +11h  8 BYTEs  ファイルシステムタイプ
                "FAT12   "  12ビットFAT
                "FAT16   "  16ビットFAT
                "CDROM   "  CD-ROM
                "CD001   "  ISO 9660 CD-ROM
                "CDAUDIO "  Audio CD

============================================================================
       DOSエラーコード表
============================================================================

00H  エラー無し
01H  ファンクションコードが無効
02H  ファイルが見つからない
03H  パス名が見つからない
04H  ファイルをオープンしすぎ
05H  アクセスできない
06H  ハンドルが無効
07H  ＭＣＢが破壊
08H  メモリが足りない
09H  メモリブロックアドレスが無効
0AH  環境が無効
0BH  書式が無効
0CH  アクセスコードが無効
0DH  データが無効
0EH  (予約)
0FH  ドライブ名が無効
10H  カレントディレクトリを削除しようとした
11H  同じデバイスではない
12H  これ以上ファイルはない
---  DOS 3.0  ---
13H  ディスクがライトプロテクトされている
14H  ディスク・ユニットが不良
15H  ドライブが準備できていない
16H  ディスクコマンドが無効
17H  ＣＲＣエラー
18H  長さが無効
19H  シークエラー
1AH  MS-DOSのディスクではない＝メディアタイプが不明
1BH  セクタが見つからない
1CH  紙切れ
1DH  書き込みエラー
1EH  読み出しエラー
1FH  一般的なエラー

20H  シェア
21H  ロック
22H  ディスク交換は不可能
23H  FCB は使用不可能
24H  シェアリングバッファが溢れた
25H  
26H  
27H  
28H  (予約)
29H  (予約)
2AH  (予約)
2BH  (予約)
2CH  (予約)
2DH  (予約)
2EH  (予約)
2FH  (予約)
30H  (予約)
31H  (予約)
32H  ネットワークリクエストはサポートされていない
33H  リモートコンピュータは聞いていない
34H  ネットワーク上で名前が衝突した(?)
35H  ネットワーク名が見付からない
36H  ネットワークがBUSY
37H  
38H  
39H  
3AH  ネットワークで不正な応答
3BH  
3CH  互換性のないリモートアダプタ
3DH  プリンタキューが一杯
3EH  プリンタキューは空いている
3FH  ファイルを印刷数にはスペースが足りない
40H  ネットワーク名が削除された
41H  ネットワーク: アクセスは許可されていない
42H  ネットワークデバイスの形式が不正
43H  ネットワーク名が見付からない
44H  
45H  
46H  
47H  	         ）   
48H  	面倒なので省略
49H  	      （      
4AH  
4BH  
4CH  
4DH  
4EH  
4FH  (予約)
50H  ファイルは存在する
51H  (予約)
52H  ディレクトリは作れない
53H  INT 24H 中にエラー
54H  リダイレクトが多すぎる
55H  リダイレクトが二重化した
56H  パスワードが不正
57H  パラメータが不正
58H  ネットワーク書き込みに失敗した
59H  ネットワーク上でサポートされていない機能
5AH  要求されたシステムはインストールされていない
64H  MSCDEX: 不明なエラー
65H  MSCDEX: 準備が出来ていない
66H  MSCDEX: EMS が足りない
67H  MSCDEX: ISO-9660 フォーマットではない
68H  MSCDEX: ドアが開いている


□致命的エラーコード

00h  書き込み禁止(ライトプロテクト等)
01h  存在しないドライブを指定
02h  ドライブが準備できていない
03h  無効なコマンドの指定
04h  CRCｴﾗｰ, ﾃﾞｰﾀｴﾗｰ
05h  ﾘｸｴｽﾄﾍｯﾀﾞの長さが不正, コマンドパケットの長さが間違っている
06h  シークエラー
07h  無効なメディアを指定, メディアタイプが間違っている
08h  指定されたセクタが存在しない, セクタが見つからない
09h  プリンタ用紙切れ
0Ah  書き込みｴﾗｰ
0Bh  読み込みｴﾗｰ
0Ch  一般的なディスク不良
0Dh  (未使用)
0Eh  (未使用)
0Fh  不正なディスク交換

============================================================================
				History
============================================================================

1998/06/29(Mon) 追加。34h 修正。
1998/07/05(Sun) 追加。修正しまくり。まだまだ････
2001/02/12(Mon) 修正。

============================================================================
                      このファイルの説明, 読み方
============================================================================


《１》内容

  このテキストファイルは, 主にアセンブラでプログラミングをする際に使用すると
思われるＭＳ--ＤＯＳの主要なファンクションコールをのせた物です. 
  ほとんどが DOS Ver.3.1以前でも動くものです. 
  ちょっと読みづらい内容ですが, その辺は勘弁してください. 

【注意】
※ＣＰ／Ｍコンパチな, 及びネットワーク関係のファンクションコールは省略してあ
ります. 


《２》見方・読み方

<例>
+---------------------------------------------------------------+
|●4EH  							|←[1]
|□一致するファイルの検索					|←[2]
|	IN  AH   AEH  						|←[3]
|	    DS:DX パス名の先頭アドレス				|
|	    CX ファイル属性					|
|	Ret CF 0 DTAに検索されたファイルの情報が書き込まれる	|←[4]
|	       1 AX 02H  	ファイルが存在しない		|
|	            12H   これ以上ファイルが存在しない		|
+---------------------------------------------------------------+

  [1]●??H  
    DOSファンクション機能番号です. 16進数でかかれてあります. 

  [2] □ﾅﾝﾀﾗｶﾝﾀﾗ
    機能の概要です. 詳しい説明はないので, 想像してください(ぉ

  [3] IN
    コールする際にどのレジスタにどのような値を格納しておけばいいかを記します. 
     IN  AH AEH とあれば, AH レジスタに16進数のAEを格納してからファンクション
     コールを実行せよという意味です. 

  [4] Ret

    コールして, 戻ってくる値です. 
     'CF 1'とあったら, キャリーフラグが1(セット)の場合をしめし, 
     'AX 03H 'とあったら, 03H  がAXレジスタに入って戻ってきた場合の説明をしめし
     ます. 
       上の例の場合, 「キャリーフラグがリセットされて戻ってきたら, DTAには検
     索されたファイルの情報が書き込まれる」ということで, 「キャリーフラグが
     セットされて戻ってきて, AXに02H  が入っていれば, ファイルが存在しない, 
     12H  が入っていれば, これ以上ファイルが存在しない」ことを示します. 

  [5]その他

    '破壊'とあったら, 元々そのレジスタにあった値が壊されるレジスタ名を羅列し
    ます. '破壊'と表記のあるレジスタは, ファンクションコールを実行したあと, 
    意味のない値が格納される可能性があるので, そのレジスタが期待通りの値を持
    っていると仮定してプログラムを組むのは危険です.
    '備考' は、そのファンクションコールを利用する際に役に立つかもしれない情報
    です. 
    その他, 注釈などがあるかもしれません. 

  [6]フラグ
    [DOS 3.0]等	そのバージョンのDOSのみ使用可能
    [DOS 3.0+]	そのバージョン以降のDOSで使用可能 (2.0以下は特に記載しない)
    [CTRL-C]	Ctrl-C/Ctrl-Break/STOP チェックを行っている
    [ECHO]	文字をエコーする (入力ファンクション系のみ)
    [PCMCIA]	PCMCIA カード関係
    その他いくつかあると思われます. 


《３》このテキストファイルについて

  ・このテキストファイルは, フリーソフトウェアとする. 
  ・このソフトの著作権は, 著者が保有する. 
  ・内容に間違い等発見された方は, お手数ですが, 下記のＩＤまで報告をお願いし
    ます. 
  ・このソフトのＢＢＳ, インターネット等への転載はβ版の場合禁止. 
  ・配布は自由. 
  ・無保証. 
  ・無責任. 
  ・バージョンアップの義務は負わない. 
  ・信頼すべき情報は Interrupt List ((C)Ralf Brown) にある. 

《４》その他

  いつ正規版作成されるかは不明. (^^;


								合著

				ZOB Station BBS    zob22243
				kattyo@anet.ne.jp
[EOF]